---
import ServerSPALayout from "../../../layouts/ServerSPALayout.astro";
import SubPage from "./sub-page.astro";
---
<ServerSPALayout title="Astro demo" filePath={Astro.self.moduleId!.replace(process.cwd(), `https://github.com/chrisdmacrae/astro-pwa/tree/main/packages`)}>
  <SubPage />

  <button id="reload" class="bg-indigo-500 hover:bg-indigo-400 px-4 py-2 rounded-xl text-white">Reload sub-frame</button>
  <script>
    import { AstroFrame, useRouter } from "astro-pwa"
 
    document.addEventListener('DOMContentLoaded', () => {
        const router = useRouter()
 
        router.on('change', () => {
            const reloadButton = document.getElementById('reload')

            reloadButton?.addEventListener('click', () => {
                const sub_frame = document.getElementById('sub_frame') as AstroFrame

                sub_frame.reload()
            })
        })
    })
  </script>
</ServerSPALayout>
